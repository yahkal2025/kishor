// טבלאות ISO 2859-1 לחישוב גודל מדגם ומספרי קבלה/דחייה

// טבלת 1: אותיות קוד לגודל מדגם
const sampleSizeCodeLetterTable = {
    "2-8": { "I": "A", "II": "A", "III": "B", "S1": "A", "S2": "A", "S3": "A", "S4": "A" },
    "9-15": { "I": "A", "II": "B", "III": "C", "S1": "A", "S2": "A", "S3": "A", "S4": "A" },
    "16-25": { "I": "B", "II": "C", "III": "D", "S1": "A", "S2": "A", "S3": "A", "S4": "A" },
    "26-50": { "I": "C", "II": "D", "III": "E", "S1": "A", "S2": "A", "S3": "B", "S4": "B" },
    "51-90": { "I": "C", "II": "E", "III": "F", "S1": "B", "S2": "B", "S3": "B", "S4": "C" },
    "91-150": { "I": "D", "II": "F", "III": "G", "S1": "B", "S2": "B", "S3": "C", "S4": "C" },
    "151-280": { "I": "E", "II": "G", "III": "H", "S1": "B", "S2": "C", "S3": "C", "S4": "D" },
    "281-500": { "I": "F", "II": "H", "III": "J", "S1": "B", "S2": "C", "S3": "D", "S4": "E" },
    "501-1200": { "I": "G", "II": "J", "III": "K", "S1": "C", "S2": "C", "S3": "D", "S4": "E" },
    "1201-3200": { "I": "H", "II": "K", "III": "L", "S1": "C", "S2": "D", "S3": "E", "S4": "F" },
    "3201-10000": { "I": "J", "II": "L", "III": "M", "S1": "C", "S2": "D", "S3": "E", "S4": "G" },
    "10001-35000": { "I": "K", "II": "M", "III": "N", "S1": "C", "S2": "D", "S3": "F", "S4": "G" },
    "35001-150000": { "I": "L", "II": "N", "III": "P", "S1": "D", "S2": "E", "S3": "G", "S4": "H" },
    "150001-500000": { "I": "M", "II": "P", "III": "Q", "S1": "D", "S2": "E", "S3": "G", "S4": "J" },
    "500001-and-over": { "I": "N", "II": "Q", "III": "R", "S1": "D", "S2": "E", "S3": "H", "S4": "J" }
};

// טבלת גודל מדגם לפי אות קוד
const sampleSizeTable = {
    "A": 2,
    "B": 3,
    "C": 5,
    "D": 8,
    "E": 13,
    "F": 20,
    "G": 32,
    "H": 50,
    "J": 80,
    "K": 125,
    "L": 200,
    "M": 315,
    "N": 500,
    "P": 800,
    "Q": 1250,
    "R": 2000,
    "S": 3150  // הוסף את זה אם חסר

};

// טבלאות מספרי קבלה ודחייה לפי סוג בדיקה ו-AQL
// כל שורה מכילה [מספר קבלה, מספר דחייה]

// בדיקה רגילה (Normal) - מדויק לפי הטבלה בתקן
const normalInspectionTable = {
    "A": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [0, 1],
        "2.5": [0, 1], "4.0": [0, 1], "6.5": [0, 1], "10": [1, 2],
        "15": [1, 2], "25": [2, 3], "40": [3, 4], "65": [5, 6],
        "100": [7, 8], "150": [10, 11], "250": [14, 15], "400": [21, 22],
        "650": [30, 31], "1000": [44, 45]
    },
    "B": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [0, 1],
        "2.5": [0, 1], "4.0": [0, 1], "6.5": [1, 2], "10": [1, 2],
        "15": [2, 3], "25": [3, 4], "40": [5, 6], "65": [7, 8],
        "100": [10, 11], "150": [14, 15], "250": [21, 22], "400": [30, 31],
        "650": [44, 45]
    },
    "C": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [0, 1],
        "2.5": [1, 2], "4.0": [1, 2], "6.5": [2, 3], "10": [3, 4],
        "15": [5, 6], "25": [7, 8], "40": [10, 11], "65": [14, 15],
        "100": [21, 22], "150": [30, 31], "250": [44, 45]
    },
    "D": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [0, 1],
        "2.5": [1, 2], "4.0": [2, 3], "6.5": [3, 4], "10": [5, 6],
        "15": [7, 8], "25": [10, 11], "40": [14, 15], "65": [21, 22],
        "100": [30, 31], "150": [44, 45]
    },
    "E": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [1, 2],
        "2.5": [2, 3], "4.0": [3, 4], "6.5": [5, 6], "10": [7, 8],
        "15": [10, 11], "25": [14, 15], "40": [21, 22], "65": [30, 31],
        "100": [44, 45]
    },
    "F": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [1, 2], "1.5": [1, 2],
        "2.5": [3, 4], "4.0": [5, 6], "6.5": [7, 8], "10": [10, 11],
        "15": [14, 15], "25": [21, 22], "40": [30, 31], "65": [44, 45]
    },
    "G": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [1, 2], "0.65": [1, 2], "1.0": [2, 3], "1.5": [3, 4],
        "2.5": [5, 6], "4.0": [7, 8], "6.5": [10, 11], "10": [14, 15],
        "15": [21, 22], "25": [30, 31], "40": [44, 45]
    },
    "H": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [1, 2],
        "0.40": [1, 2], "0.65": [2, 3], "1.0": [3, 4], "1.5": [5, 6],
        "2.5": [7, 8], "4.0": [10, 11], "6.5": [14, 15], "10": [21, 22],
        "15": [30, 31], "25": [44, 45]
    },
    "J": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [1, 2],
        "0.40": [1, 2], "0.65": [2, 3], "1.0": [2, 3], "1.5": [3, 4],
        "2.5": [5, 6], "4.0": [7, 8], "6.5": [10, 11], "10": [14, 15],
        "15": [21, 22], "25": [30, 31], "40": [44, 45]
    },
    "K": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [1, 2], "0.25": [1, 2],
        "0.40": [2, 3], "0.65": [3, 4], "1.0": [4, 5], "1.5": [6, 7],
        "2.5": [8, 9], "4.0": [11, 12], "6.5": [15, 16], "10": [21, 22],
        "15": [30, 31], "25": [44, 45]
    },
    "L": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [1, 2], "0.25": [2, 3],
        "0.40": [3, 4], "0.65": [5, 6], "1.0": [6, 7], "1.5": [8, 9],
        "2.5": [12, 13], "4.0": [18, 19], "6.5": [21, 22], "10": [30, 31],
        "15": [44, 45]
    },
    "M": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [1, 2], "0.10": [1, 2], "0.15": [2, 3], "0.25": [3, 4],
        "0.40": [4, 5], "0.65": [6, 7], "1.0": [8, 9], "1.5": [11, 12],
        "2.5": [18, 19], "4.0": [21, 22], "6.5": [30, 31], "10": [44, 45]
    },
    "N": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [1, 2], "0.10": [1, 2], "0.15": [2, 3], "0.25": [3, 4],
        "0.40": [5, 6], "0.65": [9, 10], "1.0": [13, 14], "1.5": [17, 18],
        "2.5": [21, 22], "4.0": [30, 31], "6.5": [44, 45]
    },
    "P": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [1, 2],
        "0.065": [1, 2], "0.10": [2, 3], "0.15": [3, 4], "0.25": [5, 6],
        "0.40": [7, 8], "0.65": [11, 12], "1.0": [18, 19], "1.5": [21, 22],
        "2.5": [30, 31], "4.0": [44, 45]
    },
    "Q": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [1, 2],
        "0.065": [2, 3], "0.10": [3, 4], "0.15": [5, 6], "0.25": [7, 8],
        "0.40": [10, 11], "0.65": [14, 15], "1.0": [21, 22], "1.5": [30, 31],
        "2.5": [44, 45]
    },
    "R": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [1, 2],
        "0.065": [2, 3], "0.10": [3, 4], "0.15": [5, 6], "0.25": [9, 10],
        "0.40": [14, 15], "0.65": [21, 22], "1.0": [30, 31], "1.5": [44, 45]
    }
};

// בדיקה מחמירה (Tightened)
// טבלת בחינה מחמירה (Tightened) - מעודכן לפי הטבלה ששלחת
const tightenedInspectionTable = {
    "A": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [0, 1],
        "2.5": [0, 1], "4.0": [0, 1], "6.5": [0, 1], "10": [0, 1],
        "15": [0, 1], "25": [0, 1], "40": [1, 2], "65": [1, 2],
        "100": [2, 3], "150": [3, 4], "250": [5, 6], "400": [7, 8],
        "650": [10, 11], "1000": [14, 15]
    },
    "B": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [0, 1],
        "2.5": [0, 1], "4.0": [0, 1], "6.5": [0, 1], "10": [0, 1],
        "15": [0, 1], "25": [1, 2], "40": [1, 2], "65": [2, 3],
        "100": [3, 4], "150": [5, 6], "250": [7, 8], "400": [10, 11],
        "650": [14, 15], "1000": [21, 22]
    },
    "C": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [0, 1],
        "2.5": [0, 1], "4.0": [1, 2], "6.5": [1, 2], "10": [2, 3],
        "15": [3, 4], "25": [5, 6], "40": [7, 8], "65": [10, 11],
        "100": [14, 15], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "D": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [0, 1],
        "2.5": [1, 2], "4.0": [1, 2], "6.5": [2, 3], "10": [3, 4],
        "15": [5, 6], "25": [7, 8], "40": [10, 11], "65": [14, 15],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "E": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [0, 1], "1.5": [1, 2],
        "2.5": [1, 2], "4.0": [2, 3], "6.5": [3, 4], "10": [5, 6],
        "15": [7, 8], "25": [10, 11], "40": [14, 15], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "F": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [0, 1], "1.0": [1, 2], "1.5": [1, 2],
        "2.5": [2, 3], "4.0": [3, 4], "6.5": [5, 6], "10": [7, 8],
        "15": [10, 11], "25": [14, 15], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "G": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [0, 1], "0.65": [1, 2], "1.0": [1, 2], "1.5": [2, 3],
        "2.5": [3, 4], "4.0": [5, 6], "6.5": [7, 8], "10": [10, 11],
        "15": [14, 15], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "H": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [1, 2], "0.65": [1, 2], "1.0": [2, 3], "1.5": [3, 4],
        "2.5": [5, 6], "4.0": [7, 8], "6.5": [10, 11], "10": [14, 15],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "J": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [0, 1],
        "0.40": [1, 2], "0.65": [1, 2], "1.0": [2, 3], "1.5": [3, 4],
        "2.5": [5, 6], "4.0": [7, 8], "6.5": [10, 11], "10": [14, 15],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "K": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [0, 1], "0.25": [1, 2],
        "0.40": [1, 2], "0.65": [2, 3], "1.0": [3, 4], "1.5": [5, 6],
        "2.5": [7, 8], "4.0": [10, 11], "6.5": [14, 15], "10": [21, 22],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "L": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [0, 1], "0.15": [1, 2], "0.25": [1, 2],
        "0.40": [2, 3], "0.65": [3, 4], "1.0": [5, 6], "1.5": [7, 8],
        "2.5": [10, 11], "4.0": [14, 15], "6.5": [21, 22], "10": [21, 22],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "M": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [0, 1], "0.10": [1, 2], "0.15": [1, 2], "0.25": [2, 3],
        "0.40": [3, 4], "0.65": [5, 6], "1.0": [7, 8], "1.5": [10, 11],
        "2.5": [14, 15], "4.0": [21, 22], "6.5": [21, 22], "10": [21, 22],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "N": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [0, 1],
        "0.065": [1, 2], "0.10": [1, 2], "0.15": [2, 3], "0.25": [3, 4],
        "0.40": [5, 6], "0.65": [7, 8], "1.0": [10, 11], "1.5": [14, 15],
        "2.5": [21, 22], "4.0": [21, 22], "6.5": [21, 22], "10": [21, 22],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "P": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [0, 1], "0.040": [1, 2],
        "0.065": [1, 2], "0.10": [2, 3], "0.15": [3, 4], "0.25": [5, 6],
        "0.40": [7, 8], "0.65": [10, 11], "1.0": [14, 15], "1.5": [21, 22],
        "2.5": [21, 22], "4.0": [21, 22], "6.5": [21, 22], "10": [21, 22],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "Q": {
        "0.010": [0, 1], "0.015": [0, 1], "0.025": [1, 2], "0.040": [1, 2],
        "0.065": [2, 3], "0.10": [3, 4], "0.15": [5, 6], "0.25": [7, 8],
        "0.40": [10, 11], "0.65": [14, 15], "1.0": [21, 22], "1.5": [21, 22],
        "2.5": [21, 22], "4.0": [21, 22], "6.5": [21, 22], "10": [21, 22],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "R": {
        "0.010": [0, 1], "0.015": [1, 2], "0.025": [1, 2], "0.040": [2, 3],
        "0.065": [3, 4], "0.10": [5, 6], "0.15": [7, 8], "0.25": [10, 11],
        "0.40": [14, 15], "0.65": [21, 22], "1.0": [21, 22], "1.5": [21, 22],
        "2.5": [21, 22], "4.0": [21, 22], "6.5": [21, 22], "10": [21, 22],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    },
    "S": {
        "0.010": [1, 2], "0.015": [1, 2], "0.025": [2, 3], "0.040": [3, 4],
        "0.065": [5, 6], "0.10": [7, 8], "0.15": [10, 11], "0.25": [14, 15],
        "0.40": [21, 22], "0.65": [21, 22], "1.0": [21, 22], "1.5": [21, 22],
        "2.5": [21, 22], "4.0": [21, 22], "6.5": [21, 22], "10": [21, 22],
        "15": [21, 22], "25": [21, 22], "40": [21, 22], "65": [21, 22],
        "100": [21, 22], "150": [21, 22], "250": [21, 22], "400": [21, 22],
        "650": [21, 22], "1000": [21, 22]
    }
};

// בדיקה מופחתת (Reduced)
const reducedInspectionTable = {
    "A": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [0, 2], "0.25": [0, 2],
        "0.40": [0, 2], "0.65": [0, 2], "1.0": [0, 2], "1.5": [0, 2],
        "2.5": [0, 2], "4.0": [0, 2], "6.5": [1, 3], "10": [1, 3],
        "15": [1, 3], "25": [2, 4], "40": [3, 5], "65": [5, 7],
        "100": [8, 10], "150": [12, 14], "250": [18, 20], "400": [21, 23],
        "650": [30, 32], "1000": [44, 46]
    },
    "B": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [0, 2], "0.25": [0, 2],
        "0.40": [0, 2], "0.65": [0, 2], "1.0": [0, 2], "1.5": [0, 2],
        "2.5": [0, 2], "4.0": [1, 3], "6.5": [1, 3], "10": [1, 3],
        "15": [2, 4], "25": [3, 5], "40": [5, 7], "65": [8, 10],
        "100": [12, 14], "150": [18, 20], "250": [21, 23], "400": [30, 32],
        "650": [44, 46]
    },
    "C": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [0, 2], "0.25": [0, 2],
        "0.40": [0, 2], "0.65": [0, 2], "1.0": [0, 2], "1.5": [1, 3],
        "2.5": [1, 3], "4.0": [2, 4], "6.5": [3, 5], "10": [5, 7],
        "15": [7, 9], "25": [10, 12], "40": [14, 16], "65": [21, 23],
        "100": [30, 32], "150": [44, 46]
    },
    "D": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [0, 2], "0.25": [0, 2],
        "0.40": [0, 2], "0.65": [0, 2], "1.0": [1, 3], "1.5": [1, 3],
        "2.5": [2, 4], "4.0": [3, 5], "6.5": [5, 7], "10": [8, 10],
        "15": [12, 14], "25": [18, 20], "40": [21, 23], "65": [30, 32],
        "100": [44, 46]
    },
    "E": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [0, 2], "0.25": [0, 2],
        "0.40": [0, 2], "0.65": [1, 3], "1.0": [1, 3], "1.5": [2, 4],
        "2.5": [3, 5], "4.0": [5, 7], "6.5": [8, 10], "10": [12, 14],
        "15": [18, 20], "25": [21, 23], "40": [30, 32], "65": [44, 46]
    },
    "F": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [0, 2], "0.25": [0, 2],
        "0.40": [1, 3], "0.65": [1, 3], "1.0": [2, 4], "1.5": [3, 5],
        "2.5": [5, 7], "4.0": [8, 10], "6.5": [12, 14], "10": [18, 20],
        "15": [21, 23], "25": [30, 32], "40": [44, 46]
    },
    "G": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [0, 2], "0.25": [1, 3],
        "0.40": [1, 3], "0.65": [2, 4], "1.0": [3, 5], "1.5": [5, 7],
        "2.5": [8, 10], "4.0": [12, 14], "6.5": [18, 20], "10": [21, 23],
        "15": [30, 32], "25": [44, 46]
    },
    "H": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [1, 3], "0.25": [1, 3],
        "0.40": [2, 4], "0.65": [3, 5], "1.0": [5, 7], "1.5": [8, 10],
        "2.5": [12, 14], "6.5": [18, 20], "10": [21, 23], "15": [30, 32],
        "25": [44, 46]
    },
    "J": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [0, 2], "0.15": [1, 3], "0.25": [1, 3],
        "0.40": [2, 4], "0.65": [3, 5], "1.0": [5, 7], "1.5": [8, 10],
        "2.5": [12, 14], "4.0": [18, 20], "6.5": [21, 23], "10": [30, 32],
        "15": [44, 46]
    },
    "K": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [0, 2], "0.10": [1, 3], "0.15": [1, 3], "0.25": [2, 4],
        "0.40": [3, 5], "0.65": [5, 7], "1.0": [8, 10], "1.5": [12, 14],
        "2.5": [18, 20], "4.0": [21, 23], "6.5": [30, 32], "10": [44, 46]
    },
    "L": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [1, 3], "0.10": [1, 3], "0.15": [2, 4], "0.25": [3, 5],
        "0.40": [5, 7], "0.65": [8, 10], "1.0": [12, 14], "1.5": [18, 20],
        "2.5": [21, 23], "4.0": [30, 32], "6.5": [44, 46]
    },
    "M": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [0, 2],
        "0.065": [1, 3], "0.10": [2, 4], "0.15": [3, 5], "0.25": [5, 7],
        "0.40": [8, 10], "0.65": [12, 14], "1.0": [18, 20], "1.5": [21, 23],
        "2.5": [30, 32], "4.0": [44, 46]
    },
    "N": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [1, 3],
        "0.065": [2, 4], "0.10": [3, 5], "0.15": [5, 7], "0.25": [8, 10],
        "0.40": [12, 14], "0.65": [18, 20], "1.0": [21, 23], "1.5": [30, 32],
        "2.5": [44, 46]
    },
    "P": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [0, 2], "0.040": [1, 3],
        "0.065": [3, 5], "0.10": [5, 7], "0.15": [8, 10], "0.25": [12, 14],
        "0.40": [18, 20], "0.65": [21, 23], "1.0": [30, 32], "1.5": [44, 46]
    },
    "Q": {
        "0.010": [0, 2], "0.015": [0, 2], "0.025": [1, 3], "0.040": [2, 4],
        "0.065": [5, 7], "0.10": [8, 10], "0.15": [12, 14], "0.25": [18, 20],
        "0.40": [21, 23], "0.65": [30, 32], "1.0": [44, 46]
    },
    "R": {
        "0.010": [0, 2], "0.015": [1, 3], "0.025": [2, 4], "0.040": [3, 5],
        "0.065": [7, 9], "0.10": [11, 13], "0.15": [18, 20], "0.25": [21, 23],
        "0.40": [30, 32], "0.65": [44, 46]
    }
};

// פונקציה למציאת טווח גודל המנה המתאים
function findLotSizeRange(lotSize) {
    if (lotSize < 2) return null;
    if (lotSize >= 2 && lotSize <= 8) return "2-8";
    if (lotSize >= 9 && lotSize <= 15) return "9-15";
    if (lotSize >= 16 && lotSize <= 25) return "16-25";
    if (lotSize >= 26 && lotSize <= 50) return "26-50";
    if (lotSize >= 51 && lotSize <= 90) return "51-90";
    if (lotSize >= 91 && lotSize <= 150) return "91-150";
    if (lotSize >= 151 && lotSize <= 280) return "151-280";
    if (lotSize >= 281 && lotSize <= 500) return "281-500";
    if (lotSize >= 501 && lotSize <= 1200) return "501-1200";
    if (lotSize >= 1201 && lotSize <= 3200) return "1201-3200";
    if (lotSize >= 3201 && lotSize <= 10000) return "3201-10000";
    if (lotSize >= 10001 && lotSize <= 35000) return "10001-35000";
    if (lotSize >= 35001 && lotSize <= 150000) return "35001-150000";
    if (lotSize >= 150001 && lotSize <= 500000) return "150001-500000";
    if (lotSize >= 500001) return "500001-and-over";
    return null;
}

// פונקציה לבחירת טבלת הבדיקה המתאימה
function getInspectionTable(inspectionType) {
    switch (inspectionType) {
        case "normal":
            return normalInspectionTable;
        case "tightened":
            return tightenedInspectionTable;
        default:
            return normalInspectionTable;
    }
}

// פונקציה לחישוב המדגם ומספרי קבלה/דחייה
function calculateSampling() {
    // קבלת הערכים מהטופס
    const lotSize = parseInt(document.getElementById("lot-size").value);
    const inspectionLevel = document.getElementById("inspection-level").value;
    const inspectionType = document.getElementById("inspection-type").value;
    const aql = document.getElementById("aql").value;

    // בדיקת תקינות הקלט
    if (isNaN(lotSize) || lotSize <= 0) {
        alert("נא להזין גודל מנה תקין (מספר חיובי)");
        return;
    }

    // מציאת טווח גודל המנה
    const lotSizeRange = findLotSizeRange(lotSize);
    if (!lotSizeRange) {
        alert("גודל המנה מחוץ לטווח התקף של התקן");
        return;
    }

    // קבלת אות הקוד לגודל המדגם
    const sampleSizeCodeLetter = sampleSizeCodeLetterTable[lotSizeRange][inspectionLevel];

    // קבלת גודל המדגם
    const sampleSize = sampleSizeTable[sampleSizeCodeLetter];

    // קבלת הטבלה המתאימה לסוג הבדיקה
    const inspectionTable = getInspectionTable(inspectionType);

    // קבלת מספרי קבלה ודחייה
    const acceptanceRejectionNumbers = inspectionTable[sampleSizeCodeLetter][aql];

    // בדיקה אם ערכי AQL זמינים
    if (!acceptanceRejectionNumbers) {
        alert(`לא נמצאו ערכים לאות קוד ${sampleSizeCodeLetter} ו-AQL של ${aql}%. נא לבחור ערך AQL אחר.`);
        return;
    }

    const acceptanceNumber = acceptanceRejectionNumbers[0];
    const rejectionNumber = acceptanceRejectionNumbers[1];

    // הצגת התוצאות
    document.getElementById("sample-size-code").textContent = sampleSizeCodeLetter;
    document.getElementById("sample-size").textContent = sampleSize;
    document.getElementById("acceptance-number").textContent = acceptanceNumber;
    document.getElementById("rejection-number").textContent = rejectionNumber;

    // פירוש התוצאות
    let explanationText = `לפי תקן ISO 2859-1, עבור מנה בגודל ${lotSize} ברמת בדיקה ${inspectionLevel} ו-AQL של ${aql}%, יש לבדוק מדגם של ${sampleSize} יחידות. `;
    explanationText += `אם מספר היחידות הפגומות הוא ${acceptanceNumber} או פחות, יש לקבל את המנה. `;
    explanationText += `אם מספר היחידות הפגומות הוא ${rejectionNumber} או יותר, יש לדחות את המנה.`;

    document.getElementById("result-explanation-text").textContent = explanationText;

    // עדכון התצוגה הגרפית
    updateVisualChart(acceptanceNumber, rejectionNumber);
}

// פונקציה לעדכון התצוגה הגרפית
function updateVisualChart(acceptanceNumber, rejectionNumber) {
    const maxValue = Math.max(acceptanceNumber, rejectionNumber) * 1.5 || 1;

    document.getElementById("scale-max").textContent = Math.ceil(maxValue);

    const acceptBar = document.getElementById("accept-bar");
    const rejectBar = document.getElementById("reject-bar");
    const acceptValue = document.getElementById("accept-value");
    const rejectValue = document.getElementById("reject-value");

    // עדכון הערכים
    acceptValue.textContent = acceptanceNumber;
    rejectValue.textContent = rejectionNumber;

    // יצירת אלמנטים למילוי הגרף אם לא קיימים
    if (!acceptBar.querySelector('.bar-fill')) {
        const acceptFill = document.createElement('div');
        acceptFill.className = 'bar-fill';
        acceptBar.appendChild(acceptFill);
    }

    if (!rejectBar.querySelector('.bar-fill')) {
        const rejectFill = document.createElement('div');
        rejectFill.className = 'bar-fill';
        rejectBar.appendChild(rejectFill);
    }

    // עדכון גבהי המילוי
    const acceptFill = acceptBar.querySelector('.bar-fill');
    const rejectFill = rejectBar.querySelector('.bar-fill');

    acceptFill.style.height = `${(acceptanceNumber / maxValue) * 100}%`;
    rejectFill.style.height = `${(rejectionNumber / maxValue) * 100}%`;
}

// אתחול האפליקציה עם טעינת הדף
document.addEventListener("DOMContentLoaded", function () {
    // הוספת מאזין אירוע לכפתור החישוב
    document.getElementById("calculate-btn").addEventListener("click", calculateSampling);

    // עדכון רשימת ערכי AQL כדי שתתאים לטבלה
    const aqlSelect = document.getElementById("aql");
    aqlSelect.innerHTML = ""; // ניקוי אפשרויות קיימות

    // הוספת ערכי AQL מהטבלה
    const aqlValues = [
        "0.010", "0.015", "0.025", "0.040", "0.065", "0.10", "0.15", "0.25",
        "0.40", "0.65", "1.0", "1.5", "2.5", "4.0", "6.5", "10",
        "15", "25", "40", "65", "100", "150", "250", "400", "650", "1000"
    ];

    aqlValues.forEach(value => {
        const option = document.createElement("option");
        option.value = value;
        option.textContent = value + "%";
        if (value === "1.0") {
            option.selected = true;
        }
        aqlSelect.appendChild(option);
    });

    // בדיקה וטיפול במצב כהה
    const themeSwitch = document.getElementById("theme-switch");

    // בדיקה אם המשתמש כבר בחר מצב כהה בעבר
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme === "dark") {
        document.body.classList.add("dark-theme");
        themeSwitch.checked = true;
    }

    // מאזין לשינוי בכפתור המצב
    themeSwitch.addEventListener("change", function () {
        if (this.checked) {
            document.body.classList.add("dark-theme");
            localStorage.setItem("theme", "dark");
        } else {
            document.body.classList.remove("dark-theme");
            localStorage.setItem("theme", "light");
        }
    });
});
